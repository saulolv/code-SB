<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PyLinda: prime.py</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">

  <meta name="description" content="An Python implementation of the tuplespace based distributed computing system">
  <meta name="keywords" content="python, linda, distributed computing, tuple, tuplespace, garbage collection, david gelernter, documentation">

</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>prime.py</h1>This example generates prime numbers.<p>
<b>How</b> <b>To</b> <b>Run</b> <p>
Once run ... <div class="fragment"><pre class="fragment">prime.py master
</pre></div><p>
Everywhere else run ...<p>
<div class="fragment"><pre class="fragment">prime.py
</pre></div><p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#!/usr/bin/python</span>
<span class="preprocessor"></span>
<span class="preprocessor">#    Copyright 2004 Andrew Wilkinson &lt;aw@cs.york.ac.uk&gt;.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    This file is part of PyLinda (http://www-users.cs.york.ac.uk/~aw/pylinda)</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    PyLinda is free software; you can redistribute it and/or modify</span>
<span class="preprocessor"></span><span class="preprocessor">#    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="preprocessor"></span><span class="preprocessor">#    the Free Software Foundation; either version 2.1 of the License, or</span>
<span class="preprocessor"></span><span class="preprocessor">#    (at your option) any later version.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    PyLinda is distributed in the hope that it will be useful,</span>
<span class="preprocessor"></span><span class="preprocessor">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="preprocessor"></span><span class="preprocessor">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="preprocessor"></span><span class="preprocessor">#    GNU Lesser General Public License for more details.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    You should have received a copy of the GNU Lesser General Public License</span>
<span class="preprocessor"></span><span class="preprocessor">#    along with PyLinda; if not, write to the Free Software</span>
<span class="preprocessor"></span><span class="preprocessor">#    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="preprocessor"></span>
<span class="keyword">import</span> linda
<span class="keyword">import</span> math

<span class="keyword">import</span> sys

linda.connect()

LIMIT = 10000
GRAIN = 250

def is_prime():
        primes = {}
        <span class="keywordflow">while</span> 1:
            t = ts._in((<span class="stringliteral">"next task"</span>, <span class="keywordtype">int</span>))
            start = t[1]
            if start &gt;= LIMIT:
                ts._out(("next task", start))
                return 0
            print start
            ts._out(("next task", start + GRAIN))

            for me in range(start, start + GRAIN):
                i = 2
                while i &lt;= math.sqrt(me):
                    if not primes.has_key(i):
                        ok = ts._rd(("prime", i, <span class="keywordtype">bool</span>))[2]
                        primes[i] = ok
                    else:
                        ok = primes[i]
                    if ok and (me % i == 0):
                        ts._out(("prime", me, False))
                        break
                    i = i + 1
                if i &gt; math.sqrt(me):
                    ts._out(("prime", me, True))


import sys
def main():
    ts._out(("next task", 1))

    ts._rd(("next task", LIMIT+1 ))

    linda.universe._in(("ts", linda.TupleSpace))
    print "finished"

    linda.kernel.message_noreturn("kill_server")

if __name__ == "__main__":
    if len(sys.argv) &gt; 1 and sys.argv[1] == "master":
        ts = linda.TupleSpace()
        linda.universe._out(("ts", ts))
    else:
        ts = linda.universe._rd(("ts", linda.TupleSpace))[1]

    print ts

    if len(sys.argv) &gt; 1 and sys.argv[1] == "master":
        main()
    else:
        is_prime()


</pre></div> <hr size="1">
<address style="align: right;"><small>
<a href="http://www-users.cs.york.ac.uk/~aw/pylinda">PyLinda</a> is &copy; Copyright 2004 <a href="mailto:aw at cs dot york dot ac dot uk">Andrew Wilkinson</a>.<br><br>
Generated on Mon Feb 6 10:12:05 2006 for PyLinda by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.4.0
</small></address>
</body>
</html>
