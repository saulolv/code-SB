<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PyLinda: mandelbrot.py</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">

  <meta name="description" content="An Python implementation of the tuplespace based distributed computing system">
  <meta name="keywords" content="python, linda, distributed computing, tuple, tuplespace, garbage collection, david gelernter, documentation">

</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>mandelbrot.py</h1>This example generates a mandelbrot fractal.<p>
<b>How</b> <b>To</b> <b>Run</b> <p>
Run the command... <div class="fragment"><pre class="fragment">mandelbrot.py master
</pre></div> once to start the master process.<p>
Everywhere else run ...<p>
<div class="fragment"><pre class="fragment">mandelbrot.py
</pre></div><p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#!/usr/bin/python</span>
<span class="preprocessor"></span>
<span class="preprocessor">#    Copyright 2004 Andrew Wilkinson &lt;aw@cs.york.ac.uk&gt;.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    This file is part of PyLinda (http://www-users.cs.york.ac.uk/~aw/pylinda)</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    PyLinda is free software; you can redistribute it and/or modify</span>
<span class="preprocessor"></span><span class="preprocessor">#    it under the terms of the GNU Lesser General Public License as published by</span>
<span class="preprocessor"></span><span class="preprocessor">#    the Free Software Foundation; either version 2.1 of the License, or</span>
<span class="preprocessor"></span><span class="preprocessor">#    (at your option) any later version.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    PyLinda is distributed in the hope that it will be useful,</span>
<span class="preprocessor"></span><span class="preprocessor">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="preprocessor"></span><span class="preprocessor">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="preprocessor"></span><span class="preprocessor">#    GNU Lesser General Public License for more details.</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#    You should have received a copy of the GNU Lesser General Public License</span>
<span class="preprocessor"></span><span class="preprocessor">#    along with PyLinda; if not, write to the Free Software</span>
<span class="preprocessor"></span><span class="preprocessor">#    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="preprocessor"></span>
<span class="keyword">import</span> linda
linda.connect()

import sys

MaxIters = 256*256-1

if len(sys.argv) &gt; 1 and sys.argv[1] == "master":
    out = linda.TupleSpace()
    pix = linda.TupleSpace()

    linda.universe._out(("out", out))
    linda.universe._out(("pix", pix))

    width, height = 80, 80
    left, right, top, bottom = -2.0, 1.0, -1.0, 1.0

    rls = (right - left) / width
    bts = (bottom - top) / height
    
    ylist = range(height) * width
    xlist = range(width) * height
    
    xlist.sort()
        
    map(lambda (x,y): out._out((x,y, left + x * rls, top + y * bts)), zip(xlist, ylist))
    
    import Image
    im = Image.new("RGB", (width, height))

    for i in range(height * width):
        x, y, r, g, b = pix._in((<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>))
        print "%s\r" % i,
        im.putpixel((x, y), (r, g, b))
#    ylist = range(height) * width
#    xlist = range(width) * height
    
#    xlist.sort()
#    for (x, y) in zip(xlist, ylist):
#            x, y, r, g, b = pix._in((x, y, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>))
#            print "%i,%i" % (x,y)
#            im.putpixel((x, y), (r, g, b))

    im.save("fractal.png")

    out = linda.universe._in(("out", linda.TupleSpace))[1]
    pix = linda.universe._in(("pix", linda.TupleSpace))[1]

else:
    out = linda.universe._rd(("out", linda.TupleSpace))[1]
    pix = linda.universe._rd(("pix", linda.TupleSpace))[1]

    col_mul = (2**24-1)/<span class="keywordtype">float</span>(MaxIters)

    while True:
        t = out._inp((<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">float</span>, <span class="keywordtype">float</span>))
        if t is None:
            break

        (x, y, cr, ci) = t
        print "in", x, y

        #Z = 0 + 0j
        #C = cr + ci*1j

        #count = -1
        #while abs(Z) &lt;= 2.0 and count &lt; MaxIters:
        #     count += 1

             #Z = Z * Z + C

        zr, zi = 0.0, 0.0
        rsquared = zr * zr
        isquared = zi * zi
        count = -1
        while rsquared + isquared &lt;= 4.0 and count &lt; MaxIters:
            count += 1

            zi = zr * zi * 2 + ci
            zr = rsquared - isquared + cr

            rsquared = zr * zr
            isquared = zi * zi

        count = <span class="keywordtype">int</span>(count * col_mul)

        pix._out((x, y, count%256, (count&gt;&gt;8)%256, (count&gt;&gt;16)%256))


</pre></div> <hr size="1">
<address style="align: right;"><small>
<a href="http://www-users.cs.york.ac.uk/~aw/pylinda">PyLinda</a> is &copy; Copyright 2004 <a href="mailto:aw at cs dot york dot ac dot uk">Andrew Wilkinson</a>.<br><br>
Generated on Mon Feb 6 10:12:04 2006 for PyLinda by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.4.0
</small></address>
</body>
</html>
